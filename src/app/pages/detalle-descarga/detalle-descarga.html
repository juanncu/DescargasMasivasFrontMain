<div class="detalle-wrapper">

  <button class="btn-volver" (click)="volver()">
    <mat-icon style="font-size: 16px; height: 16px; width: 16px;">arrow_back</mat-icon> Volver al historial
  </button>

  <div class="titulo" *ngIf="detalle">
    <h2>{{ detalle.delegacion }}</h2>
    <span class="estado" [ngClass]="{'ok': detalle.estado === 'COMPLETADO', 'error': detalle.estado !== 'COMPLETADO'}">
      {{ detalle.estado }}
    </span>
  </div>

  <div *ngIf="detalle">
    <p style="color: #666; margin-left: 5px;" class="detalle-mes">{{ detalle.mes }}</p>

    <div class="grid grid-cols-4 gap-4 mb-8">
      <div class="stat-card">
        <span class="label">PDFs</span>
        <span class="value">{{ detalle?.totalPdf || 0 }}</span>
      </div>

      <div class="stat-card">
        <span class="label">XMLs</span>
        <span class="value">{{ detalle?.totalXml || 0 }}</span>
      </div>

      <div class="stat-card">
        <span class="label">Recibos</span>
        <span class="value">{{ detalle?.totalRecibos || 0 }}</span>
      </div>

      <div class="stat-card" [ngClass]="{'has-errors': detalle.omitidos > 0}">
        <span class="label">Omitidos</span>
        <span class="value" [class.text-danger]="detalle.omitidos > 0">
          {{ detalle.omitidos || 0 }}
        </span>
      </div>
    </div>

    <div class="info-box">
      <div class="info-header">
        Detalles TÃ©cnicos
      </div>
      <div class="info-content">
        <p><strong>Ruta de la descarga:</strong> {{ detalle.ruta }}</p>
        <p><strong>Inicio de descarga:</strong> {{ detalle.inicio }}</p>
        <p><strong>Fin de la descarga:</strong> {{ detalle.fin }}</p>
        <p><strong>Tiempo:</strong> {{ detalle.tiempo }}</p>
      </div>
    </div>

    <h3>Registro de actividad</h3>
    <div class="log">
      <div *ngFor="let r of detalle.registros" [class.OK]="r.estado === 'OK'" [class.ERROR]="r.estado === 'ERROR'">
        [{{ r.estado }}] {{ r.mensaje }}
      </div>
    </div>

    <div class="acciones">
      <button class="btn retry" *ngIf="detalle.errores > 0">
        Reintentar
      </button>
      <button class="btn open">Abrir carpeta</button>
    </div>
  </div>

</div>