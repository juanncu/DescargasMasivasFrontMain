<div class="main-container">

  <div class="acciones-superiores">
    <button routerLink="/historial-descargas" class="btn-regresar">
      <mat-icon>history</mat-icon> Ver descargas
    </button>
  </div>

  <h2 class="main-title">DESCARGA MASIVA DE FOLIOS</h2>

  <div class="card-descarga">
    <div class="info-header">
      Filtros de descarga
    </div>

    <div class="info-filtros">
      
      <div class="filter-row">
        <span class="filter-label">Estado:</span>
        <div class="options-group">
          <label class="radio-borde">
            <input type="radio" name="estado" [(ngModel)]="estadoSeleccionado" value="Activo">
            Activo
          </label>
          <label class="radio-borde">
            <input type="radio" name="estado" [(ngModel)]="estadoSeleccionado" value="Cancelar">
            Cancelar
          </label>
          <label class="radio-borde">
            <input type="radio" name="estado" [(ngModel)]="estadoSeleccionado" value="Ambos">
            Ambos
          </label>
        </div>
      </div>

      <div class="filter-row">
        <span class="filter-label">Padrón:</span>
        <div class="options-group">
          <label class="radio-borde">
            <input type="radio" name="padron" [(ngModel)]="padronSeleccionado" value="Todas">
            Todas
          </label>
          <label class="radio-borde">
            <input type="radio" name="padron" [(ngModel)]="padronSeleccionado" value="Predial">
            Predial
          </label>
        </div>
      </div>

      <div class="grid-meses">
        <div class="input-group">
          <label>Mes de Inicio:</label>
          <select [(ngModel)]="mesInicio" class="custom-select">
            <option value="">Seleccionar</option>
            <option *ngFor="let m of meses" [value]="m.id">{{ m.nombre }}</option>
          </select>
        </div>
        <div class="input-group">
          <label>Mes Final:</label>
          <select [(ngModel)]="mesFinal" class="custom-select">
            <option value="">Seleccionar</option>
            <option *ngFor="let m of meses" [value]="m.id">{{ m.nombre }}</option>
          </select>
        </div>
      </div>

      <div class="input-group">
        <label>Año:</label>
        <input type="number" [(ngModel)]="anio" class="custom-input small-input">
      </div>

      <div class="input-group">
        <label class="large-label">Seleccione una Delegación:</label>
        <select [(ngModel)]="delegacionSeleccionada" class="custom-select">
          <option value="">Seleccionar</option>
          <option *ngFor="let item of listaDelegaciones" [value]="item.Id">
            {{ item.Nombre }}
          </option>
        </select>
      </div>

      <div class="button-container">
        <button (click)="buscar()" class="btn-buscar">
          BUSCAR
        </button>
      </div>

    </div>
  </div>

  <div *ngIf="resultados" class="resultados-container">
    <div class="info-header" style="background: #e5e5e5; color: #333; border-bottom: 1px solid #ccc;">
      Resultados de la búsqueda
    </div>
    <div class="info-filtros">
      <div class="resultados-grid">
        <p><strong>Archivos encontrados:</strong> {{ resultados.archivos }}</p>
        <p><strong>Tamaño aprox:</strong> {{ resultados.tamanio }}</p>
      </div>
      <p class="resultado-tiempo">Tiempo estimado: {{ resultados.tiempo }}</p>
      
      <div class="button-container">
        <button (click)="confirmarDescarga()" class="btn-confirmar">
          CONFIRMAR DESCARGA
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="mostrarPopupConfirmacion" style="position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 50;">
    <div class="card-descarga" style="max-width: 400px; text-align: center; padding: 20px;">
      <div style="font-size: 40px; color: green;">✓</div>
      <h2 class="main-title" style="margin-bottom: 10px;">¡Descarga iniciada!</h2>
      <p>Los archivos se están procesando.</p>
      <div class="button-container" style="flex-direction: column; gap: 10px;">
        <button (click)="irAlHistorial()" class="btn-buscar">Ver descargas</button>
        <button (click)="reiniciarFiltros()" class="btn-regresar" style="justify-content: center;">Nueva descarga</button>
      </div>
    </div>
  </div>

</div>