<main class="main-container bg-gray-100 flex flex-col items-center p-4">
  <div class="w-full max-w-4xl mb-4">
    <button routerLink="/historial-descargas" class="text-blue-600 hover:underline flex items-center gap-2">
      ⬇️ | Ver descargas
    </button>
  </div>

  <h2 class="text-2xl font-bold text-gray-800 mb-6">DESCARGA MASIVA DE FOLIOS</h2>

  <div class="bg-white w-full max-w-4xl rounded-lg shadow-md p-6 mb-6">
    <div class="border-b pb-2 mb-4">
      <h3 class="text-lg font-semibold text-gray-700">Filtros de descarga</h3>
    </div>

    <div class="grid gap-4">
      <div class="flex items-center gap-4">
        <span class="font-medium min-w-[80px]">Estado:</span>
        <div class="flex gap-4 p-2 border rounded-md w-full">
          <label class="cursor-pointer"><input type="radio" name="estado" [(ngModel)]="estadoSeleccionado" value="Activo"> Activo</label>
          <label class="cursor-pointer"><input type="radio" name="estado" [(ngModel)]="estadoSeleccionado" value="Cancelar"> Cancelar</label>
          <label class="cursor-pointer"><input type="radio" name="estado" [(ngModel)]="estadoSeleccionado" value="Ambos"> Ambos</label>
        </div>
      </div>

      <div class="flex items-center gap-4">
        <span class="font-medium min-w-[80px]">Padrón:</span>
        <div class="flex gap-4 p-2 border rounded-md w-full">
          <label class="cursor-pointer"><input type="radio" name="padron" [(ngModel)]="padronSeleccionado" value="Todas"> Todas</label>
          <label class="cursor-pointer"><input type="radio" name="padron" [(ngModel)]="padronSeleccionado" value="Predial"> Predial</label>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">Mes de Inicio:</label>
          <select [(ngModel)]="mesInicio" class="w-full border rounded p-2">
            <option value="">Seleccionar</option>
            <option *ngFor="let m of meses" [value]="m.id">{{ m.nombre }}</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Mes Final:</label>
          <select [(ngModel)]="mesFinal" class="w-full border rounded p-2">
            <option value="">Seleccionar</option>
            <option *ngFor="let m of meses" [value]="m.id">{{ m.nombre }}</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Año:</label>
          <input type="number" [(ngModel)]="anio" class="w-full border rounded p-2">
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Seleccione una Delegación:</label>
        <select [(ngModel)]="delegacionSeleccionada" class="w-full border rounded p-2">
          <option value="">Seleccionar</option>
          <option *ngFor="let item of listaDelegaciones" [value]="item.Id">
            {{ item.Nombre }}
          </option>
        </select>
      </div>

      <div class="flex justify-center mt-4">
        <button (click)="buscar()" class="bg-yellow-700 text-white px-8 py-2 rounded-lg hover:bg-yellow-800 font-bold shadow transition-transform active:scale-95">
          BUSCAR
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="resultados" class="bg-white w-full max-w-4xl rounded-lg shadow-md p-6 mb-6">
    <div class="border-b pb-2 mb-4">
      <h3 class="text-lg font-semibold text-gray-700">Resultados de la búsqueda:</h3>
    </div>
    <div class="grid grid-cols-2 gap-4 text-center">
      <p class="text-gray-700"><strong>Archivos encontrados:</strong> {{ resultados.archivos }}</p>
      <p class="text-gray-700"><strong>Tamaño aprox:</strong> {{ resultados.tamanio }}</p>
    </div>
    <p class="text-center mt-4 text-sm text-gray-500">
      <strong>Tiempo aproximado de descarga:</strong> {{ resultados.tiempo }}
    </p>
    
    <div class="flex justify-center mt-6">
      <button (click)="confirmarDescarga()" class="bg-green-700 text-white px-8 py-3 rounded-lg hover:bg-green-800 font-bold shadow transition-transform active:scale-95">
        CONFIRMAR DESCARGA
      </button>
    </div>
  </div>

  <div *ngIf="mostrarPopupConfirmacion" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-8 text-center space-y-5">
      <div class="mx-auto flex items-center justify-center h-14 w-14 rounded-full bg-green-100">
        <span class="text-green-600 text-3xl font-bold">✓</span>
      </div>
      <div class="space-y-2">
        <h2 class="text-xl font-bold text-gray-900 italic">¡Descarga en proceso!</h2>
        <p class="text-sm text-gray-600">Los archivos están en proceso para su descarga.</p>
      </div>
      <div class="flex flex-col gap-3 pt-2">
        <button (click)="irAlHistorial()" class="w-full py-3 bg-red-700 text-white font-bold rounded-xl hover:bg-red-800 transition-all uppercase">
          Ver descargas
        </button>
        <button (click)="reiniciarFiltros()" class="w-full py-3 bg-gray-800 text-white font-bold rounded-xl hover:bg-black transition-all uppercase">
          Hacer otra descarga
        </button>
        <button (click)="mostrarPopupConfirmacion = false" class="w-full py-2 text-gray-500 text-sm hover:underline font-medium">
          Cerrar ventana
        </button>
      </div>
    </div>
  </div>
</main>